<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>MX - Breakdown of Pillar</title>
		<link rel="icon" href="favicon.ico?" type="image/x-icon">
		<link rel="stylesheet" href="https://use.typekit.net/tsn4urm.css">
		<link rel="stylesheet" href="style.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<body id="dark">
		<div class="with-sidebar">
			<div>
		  		<!-- sidebar -->
				<nav>
					<span><h1><a href="home.html">Home</a></h1></span>
					<span><h1><a href="now.html">now</a></h1></span>
					<span><h1><a href="wiki.html">wiki</a></h1></span>
					<span><h1><a href="about.html">about</a></h1></span>
				</nav>
			</div>
			<div>
				<main>
					<!-- non-sidebar -->
					<article class="inner">

<mark>UNDER CONSTRUCTION</mark>

<h2>Breakdown of Pillar</h2>

<p>Pillar is my custom static site generator, used to build this <a href="site.html">site</a>. While my site is probably still small enough that I could build it by hand, writing my own site generator (with a custom-ish markup language) was and is a lot of fun :></p>

<p>You can find the source code to Pillar in any of these places:</p>
<ul>
	<li><a href="https://codeberg.org/flbr/Pillar">codeberg</a></li>
	<li><a href="https://github.com/flber/Pillar">github</a></li>
	<li><a href="https://git.sr.ht/~flber/pillar">srht</a></li>
</ul>

<p>This page will serve not as documentation for Pillar (though if that's what you're curious about you can look through the readme in the repo linked above), but as a thorough explantion of how it works. Because I'm almost constantly working on it, I'll try and keep this as up-to-date as possible and give a general outline of what my future plans are.</p>

<p>Because I want this to be as specific as possible, I'll be including line numbers to reference larger blocks of code and actual code for smaller pieces which I feel deserve their own line-by-line explanations. This is, of course, highly dependent on the version of pillar, so below is a link to the exact commit I'm talking about.</p>

<p><a href="https://git.sr.ht/~flber/pillar/tree/f3d5479abcbe382b649147781a882a73c212c06b">f3d5479a</a></p>


<h3>Command-line argument parsing</h3>

<p>Lines <a href="https://git.sr.ht/~flber/pillar/tree/f3d5479abcbe382b649147781a882a73c212c06b/item/src/main.rs#L47-77">47 to 77</a> reads the given command line arguments and sets three flags, <code>should_build</code>, <code>debug_active</code>, and <code>build_all</code>, which affect how pillar runs. If any invalid input is given, nothing is run and the program simply returns the help menu.</p>


<h3>Config unwrapping and initial setup</h3>

<p>If <code>should_build</code> is true, pillar will run. It first gets some config information (either creating a <code>.pillar.toml</code> file if it doesn't exist, or reading an existing config file), and uses that to find the input and output folders.</p>

<p>To generate pages, it iterates through all <code>.gn</code> files in the directory given by the config file:</p>

<p><a href="https://git.sr.ht/~flber/pillar/tree/f3d5479abcbe382b649147781a882a73c212c06b/item/src/main.rs#L83-87">L83-87</a></p>
<pre>
for e in fs::read_dir(&config.granite_path)? {
  let entry = e?;
  // normalizes path str
  let path = format!("{:?}", entry.path());
  let path_str = slice(&path, 1..len(&path) - 1);
  ...
</pre>

<p></p>


<h3>Begining of parsing</h3>


<h3>Header Parsing</h3>


<h3>Debug output</h3>


<h3>Granite parsing</h3>


<h3>Templating</h3>


<h3>Plugins</h3>

					</article>
				</main>
			</div>
		</div>
		<footer>
			<a href="mailto:benrhammond@gmail.com" target="_blank">
				<img src="images/mail.svg" alt="Mailto"/>
			</a>
			<a rel="me" href="https://merveilles.town/@flbr" target="_blank">
				<img src="images/merveilles.svg" alt="Merveilles"/>
			</a>
			<a rel="me" href="https://github.com/flber" target="_blank">
				<img src="images/github.svg" alt="Github"/>
			</a>
        	<a href='https://webring.xxiivv.com/#icons' target='_blank'>
        		<img class="webring" src="images/webring-icon-black.svg" alt="the merveilles webring"/>
       		</a>
        	<a href="https://wiki.xxiivv.com/site/uxn.html">
        		<img src="images/uxn-icon.svg" alt="Uxn Powered"/>
       		</a>
        	<a href="https://wiki.xxiivv.com/site/ethics.html">
        		<img src="images/dreipfeile-icon.svg" alt="Ethics"/>
       		</a>
        	<a href="feed.xml">
        		<img src="images/rss.svg" alt="RSS Feed"/>
       		</a>
			<span style="float: right;"><em>Last updated: 130422</em></span>
		</footer>
	</body>
</html>
